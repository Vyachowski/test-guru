<% content_for :title do %>
  Добавить новый тест <%= @test.title %>
<% end %>

<%= link_to 'Назад', tests_path %>

<h1><%= test_header @test.title %></h1>

<%= form_with model: @test, data: { turbo: false } do |form| %>
  <fieldset>
    <%= form.label :body, "Название теста:" %><br>
    <%= form.text_field :title, id: :test_title %>

    <%= form.label :level, "Уровень" %>
    <%= form.number_field :level, id: :test_level, min: 0, max: 4 %>

    <%= form.label :category_id, "Категория" %>:
    <%= form.collection_select :category_id, Category.all, :id, :title %>

    <%= form.hidden_field :creator_id, value: 1 %>
  </fieldset>

  <div>
    <%= form.submit "Добавить тест", id: "submit_button", disabled: true %>
  </div>
<% end %>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const textarea = document.getElementById("test_title");
    const submitBtn = document.getElementById("submit_button");

    function setDisabled() {
      submitBtn.disabled = textarea.value.trim() === "";
    }

    textarea.addEventListener("input", setDisabled);

    setDisabled();
  });
</script>
